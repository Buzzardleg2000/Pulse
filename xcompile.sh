#!/bin/bash

# This file builds Pulse for many of the systems needed for our Pulse Unity Asset
# Run this script from your Pulse source directory
# It will create a new directory next to your source directory called 'dockcross-builds'
# All builds will be placed here, and the binaries you need will be in each install directory
# Note that for Android builds, you need to already have a completed build
# The android protoc compiler cannot run on our linux based docker host
# So we need to get those autogenerated files from a different build


cwd=$PWD
srcDir=${PWD##*/}  

cd ..
if [ ! -d $buildDir ]
then
  mkdir dockcross-builds
fi

$cwd/dockcross.sh manylinux2010-x64 ./$srcDir ./dockcross-builds
$cwd/dockcross.sh android-arm ./$srcDir ./dockcross-builds ./dockcross-builds/pulse-engine-manylinux2010-x64
$cwd/dockcross.sh android-arm64 ./$srcDir ./dockcross-builds ./dockcross-builds/pulse-engine-manylinux2010-x64
$cwd/dockcross.sh linux-x64-clang ./$srcDir ./dockcross-builds

cd $cwd